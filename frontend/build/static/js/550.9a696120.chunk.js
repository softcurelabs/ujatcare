"use strict";(self.webpackChunkujatcare=self.webpackChunkujatcare||[]).push([[550],{90550:(e,s,t)=>{t.r(s),t.d(s,{default:()=>A});var r=t(9950),a=t(9449),n=t(56035),l=t(86781),i=t(68459),d=t(64055),o=t(86133),u=t(13059),c=t(27081),m=t(28429),h=t(42074),j=t(80183),x=t(82612),v=t(26473),g=t(60666),_=t(96944),b=t(44414);const p=()=>{var e;const s=(0,v.t)(g.Ik().shape({work_requested:g.Yj().required("Please select Work Requested"),tanent_name:g.Yj().required("Please enter tanent name"),phone:g.Yj().required("Please enter phone name"),ok_to_enter:g.Yj().required("Please select ok to enter"),tanent_signature:g.Yj().required().matches(/^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/,"Signature must be png")})),[t,o]=(0,r.useState)(""),[p,A]=(0,r.useState)(""),[f,w]=(0,r.useState)(!1),[S,k]=(0,r.useState)(),[N,y]=(0,r.useState)();let{user:L,customerUser:q}=(0,c.d4)((e=>({user:e.Auth.user,customerUser:e.CustomerAuth.user})));L||(L=q);const Z=(0,a.mN)({defaultValues:{},resolver:s}),{handleSubmit:D,register:F,setError:R,control:U,setValue:Y,formState:{errors:C}}=Z,P=(0,c.wA)();let E=(0,r.useRef)(null),M=(0,r.useRef)(null);const[T,I]=(0,r.useState)(new Date),[V,B]=(0,r.useState)(new Date),[G,H]=(0,r.useState)(new Date);(0,r.useEffect)((()=>{P((0,j.Tv)(L.user_id)).unwrap().then((e=>{y(e),P((0,u.Xs)(z.id)).unwrap().then((e=>{var s;if(null!==e){var t,r;if(k(e),Y("id",e.id),Y("tanent_name",null===e||void 0===e?void 0:e.tanent_name),Y("work_requested",null===e||void 0===e?void 0:e.work_requested),Y("tanent_signature",null===e||void 0===e?void 0:e.tanent_signature),null===(s=E.current)||void 0===s||s.fromDataURL(null===e||void 0===e?void 0:e.tanent_signature),M.current&&M.current.fromDataURL(null===e||void 0===e?void 0:e.service_signature),Y("phone",null===e||void 0===e?void 0:e.phone),Y("ok_to_enter",null===e||void 0===e?void 0:e.ok_to_enter.toString()),null!==e&&void 0!==e&&e.action_taken&&Y("action_taken",null===e||void 0===e?void 0:e.action_taken),Y("work_done",null===e||void 0===e?void 0:e.work_done),Y("status",null===e||void 0===e?void 0:e.status.toString()),null!==e&&void 0!==e&&e.chargable&&Y("chargable",null===e||void 0===e?void 0:e.chargable.toString()),null!==e&&void 0!==e&&e.action_date&&I(new Date(null===e||void 0===e?void 0:e.action_date)),null!==e&&void 0!==e&&e.time_in&&B(new Date("2024-12-12 "+(null===e||void 0===e?void 0:e.time_in))),null!==e&&void 0!==e&&e.time_out&&B(new Date("2024-12-12 "+(null===e||void 0===e?void 0:e.time_out))),M)null===(t=M.current)||void 0===t||t.off();if(E)null===(r=E.current)||void 0===r||r.off()}})).catch((e=>A(e)))}))}),[L.user_id]);const O=D((async e=>{w(!0),P((0,u.ag)(e)).unwrap().then((e=>{e&&!0===e.status?(o(e.message),A(""),window.scrollTo({top:0,behavior:"smooth"})):A(null===e||void 0===e?void 0:e.message),w(!1)})).catch((e=>{for(var s in e.errors)try{R(s,{message:e.errors[s].toString()})}catch(t){}w(!1)}))})),z=(0,m.g)();return(0,b.jsxs)(b.Fragment,{children:[t&&(0,b.jsxs)("div",{className:"alert alert-success",children:[t,(0,b.jsx)(h.N_,{to:"/maintanance",children:" Back to Maintanance."})]}),p&&(0,b.jsx)("div",{className:"alert alert-danger mt-3",role:"alert",children:p}),N&&(0,b.jsx)("form",{onSubmit:O,children:(0,b.jsx)(n.A,{children:(0,b.jsxs)(n.A.Body,{children:[(0,b.jsxs)(l.A,{children:[(0,b.jsx)(i.A,{lg:4,children:(0,b.jsxs)(d.A.Group,{className:"mb-3",children:[(0,b.jsx)(d.A.Label,{className:"me-2",children:"Building: "}),(0,b.jsx)(d.A.Label,{children:N&&N.user.apartment_name}),(0,b.jsx)(x.Z,{type:"hidden",name:"user_id",value:L.user_id,disabled:!0,register:F}),(0,b.jsx)(x.Z,{type:"hidden",name:"id",register:F,disabled:!0})]})}),(0,b.jsx)(i.A,{lg:3,children:(0,b.jsxs)(d.A.Group,{className:"mb-3 input-group",children:[(0,b.jsx)(d.A.Label,{htmlFor:"small",className:"me-2",children:"Suite:"}),(0,b.jsx)(d.A.Label,{children:N&&N.user.flat_name}),(0,b.jsx)(x.Z,{type:"hidden",disabled:!0,name:"flat_id",value:N&&(null===(e=N.user.flat)||void 0===e?void 0:e.flat_id),register:F})]})})]}),(0,b.jsxs)(l.A,{children:[(0,b.jsxs)(i.A,{lg:4,children:[(0,b.jsx)(d.A.Label,{className:"me-2",children:"Tanent Name: "}),(0,b.jsx)(d.A.Label,{children:S&&S.tanent_name}),(0,b.jsx)(x.Z,{type:"hidden",disabled:!0,register:F,name:"tanent_name",errors:C},"tanent_name")]}),(0,b.jsxs)(i.A,{lg:3,children:[(0,b.jsx)(d.A.Label,{className:"me-2",children:"Tanent Phone: "}),(0,b.jsx)(d.A.Label,{children:S&&S.phone}),(0,b.jsx)(x.Z,{type:"hidden",disabled:!0,name:"phone",register:F,errors:C},"phone")]}),(0,b.jsx)(i.A,{lg:5,children:(0,b.jsxs)(d.A.Group,{className:"mb-3 input-group",children:[(0,b.jsx)(d.A.Label,{htmlFor:"small",className:"me-2",children:"Ok to Enter:"}),(0,b.jsx)(d.A.Label,{children:S&&"1"==S.ok_to_enter?"Yes":"No"}),(0,b.jsx)(x.Z,{type:"hidden",disabled:!0,className:"form-check-inline",name:"ok_to_enter",register:F})]})})]}),(0,b.jsx)(l.A,{children:(0,b.jsxs)(i.A,{lg:12,children:[(0,b.jsx)(d.A.Label,{htmlFor:"small",className:"me-2",children:"Request:"}),(0,b.jsx)(d.A.Label,{children:S&&S.work_requested}),(0,b.jsx)(x.Z,{type:"hidden",name:"work_requested",disabled:!0,register:F,errors:C})]})})]})})}),(0,b.jsx)(l.A,{children:z&&z.id&&(0,b.jsx)(_.L,{load:f,id:z.id})})]})},A=()=>(0,b.jsxs)(r.Fragment,{children:[(0,b.jsx)(o.A,{breadCrumbItems:[{label:"Dashboard",path:"/dashboard-1"},{label:"Maintanance Create",path:"/maintanance/create",active:!0}],title:"Maintanance Request"}),(0,b.jsx)(l.A,{children:(0,b.jsx)(i.A,{children:(0,b.jsx)(p,{})})})]})},96944:(e,s,t)=>{t.d(s,{L:()=>g});var r=t(9950),a=t(82612),n=t(13059),l=t(27081),i=t(68459),d=t(56035),o=t(86994),u=t(6863),c=t(97937),m=t(88249),h=t(9449),j=t(26473),x=t(60666),v=t(44414);const g=e=>{let{id:s,admin:t=!1,load:g}=e;const _=(0,l.wA)(),[b,p]=(0,r.useState)(!1),[A,f]=(0,r.useState)([]),w=(0,j.t)(x.Ik().shape({message:x.Yj().required("Please enter message")}));let{user:S,customerUser:k}=(0,l.d4)((e=>({user:e.Auth.user,customerUser:e.CustomerAuth.user})));const[N,y]=(0,r.useState)(""),[L,q]=(0,r.useState)("");S||(S=k);const Z=(0,h.mN)({defaultValues:{},resolver:w}),{handleSubmit:D,register:F,setError:R,control:U,watch:Y,setValue:C,reset:P,formState:{errors:E}}=Z;(0,r.useEffect)((()=>{_((0,n.OH)(s)).unwrap().then((e=>{e&&f(e)}))}),[s,b,g]);const M=D((async e=>{p(!0),_((0,n.gs)(e)).unwrap().then((e=>{e&&!0===e.status&&(y(e.message),q(""),p(!1),P())})).catch((e=>{for(var s in e.errors)try{R(s,{message:e.errors[s].toString()})}catch(t){}p(!1)}))}));return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(i.A,{children:[A&&(0,v.jsx)("h4",{children:"Updates"}),A&&A.map((e=>(0,v.jsxs)(d.A,{children:[(0,v.jsx)(o.A,{className:"border-bottom",children:(0,v.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,v.jsx)("strong",{children:e.sender&&e.sender.name}),(0,v.jsx)("div",{children:e.created_at})]})}),(0,v.jsx)(u.A,{dangerouslySetInnerHTML:{__html:e.message.toString()}})]})))]}),(0,v.jsxs)("form",{onSubmit:M,className:"mb-2",children:[N&&(0,v.jsx)("div",{className:"alert alert-success",children:N}),L&&(0,v.jsx)("div",{className:"alert alert-danger mt-3",role:"alert",children:L}),!t&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(a.Z,{type:"textarea",rows:"5",className:"mb-2",name:"message",title:"Message",register:F}),(0,v.jsx)(a.Z,{type:"hidden",name:"maintanance_id",value:s,register:F}),S&&(0,v.jsx)(a.Z,{type:"hidden",name:"sender_id",value:S.user_id,register:F}),(0,v.jsx)(i.A,{lg:3,children:b?(0,v.jsx)(m.m,{}):(0,v.jsx)(c.A,{variant:"primary",type:"submit",children:"Submit"})})]})]})]})}}}]);