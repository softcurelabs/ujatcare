"use strict";(self.webpackChunkujatcare=self.webpackChunkujatcare||[]).push([[2213],{63112:(e,s,t)=>{t.d(s,{A:()=>r});var a=t(72348),n=t.n(a),i=(t(4434),t(44414));const r=e=>(0,i.jsx)(i.Fragment,{children:e.showTimeSelectOnly?(0,i.jsx)(n(),{name:e.name,timeIntervals:e.tI,selected:e.value,onChange:s=>e.onChange(s),showTimeSelect:e.showTimeSelect,timeFormat:"hh:mm a",timeCaption:e.timeCaption,dateFormat:"hh:mm",className:"form-control",minDate:e.minDate,scrollableYearDropdown:!0,scrollableMonthYearDropdown:!0,maxDate:e.maxDate,disabled:e.disabled,monthsShown:e.monthsShown,wrapperClassName:"is-invalid",showTimeSelectOnly:e.showTimeSelectOnly,inline:e.inline,autoComplete:"off"}):(0,i.jsx)(n(),{name:e.name,timeIntervals:e.tI,selected:e.value,onChange:s=>e.onChange(s),showTimeSelect:e.showTimeSelect,timeFormat:"hh:mm a",timeCaption:e.timeCaption,dateFormat:e.dateFormat,minDate:e.minDate,disabled:e.disabled,wrapperClassName:"is-invalid",className:"form-control",maxDate:e.maxDate,showMonthDropdown:!0,showYearDropdown:!0,scrollableMonthYearDropdown:!0,monthsShown:e.monthsShown,showTimeSelectOnly:e.showTimeSelectOnly,inline:e.inline,autoComplete:"off"})})},80730:(e,s,t)=>{t.d(s,{A:()=>m});var a=t(9950),n=t(42074),i=t(56035),r=t(86781),l=t(68459),o=t(36275),c=t(44414);const d=e=>{const[s,t]=(0,a.useState)([]),d=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";const t=s<0?0:s,a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(t))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][a]};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o.Ay,{...e,onDrop:a=>(a=>{var n=a;e.showPreview&&((a||[]).map((e=>Object.assign(e,{preview:"image"===e.type.split("/")[0]?URL.createObjectURL(e):null,formattedSize:d(e.size)}))),(n=s).push(...a),t(n)),e.onFileUpload&&e.onFileUpload(n)})(a),children:s=>{let{getRootProps:t,getInputProps:a}=s;return(0,c.jsx)("div",{className:"dropzone",children:(0,c.jsxs)("div",{className:"dz-message needsclick",...t(),children:[(0,c.jsx)("input",{...a()}),(0,c.jsx)("i",{className:"h3 text-muted dripicons-cloud-upload"}),(0,c.jsx)("h4",{children:e.title?e.title:"Drop Image or Document here or click to upload."}),(0,c.jsx)("span",{className:"text-muted font-13"})]})})}}),e.showPreview&&(0,c.jsx)("div",{className:"dropzone-previews mt-3",id:"uploadPreviewTemplate",children:(s||[]).map(((a,o)=>(0,c.jsx)(i.A,{className:"mt-1 mb-0 shadow-none border",children:(0,c.jsx)("div",{className:"p-2",children:(0,c.jsxs)(r.A,{className:"align-items-center",children:[a.preview&&(0,c.jsx)(l.A,{className:"col-auto",children:(0,c.jsx)("img",{"data-dz-thumbnail":"",className:"avatar-sm rounded bg-light",alt:a.name,src:a.preview})}),!a.preview&&(0,c.jsx)(l.A,{className:"col-auto",children:(0,c.jsx)("div",{className:"avatar-sm",children:(0,c.jsx)("span",{className:"avatar-title bg-primary rounded",children:a.type.split("/")[0]})})}),(0,c.jsxs)(l.A,{className:"ps-0",children:[(0,c.jsx)(n.N_,{to:"#",className:"text-muted fw-bold",children:a.name}),(0,c.jsx)("p",{className:"mb-0",children:(0,c.jsx)("strong",{children:a.formattedSize})})]}),(0,c.jsx)(l.A,{className:"text-end",children:(0,c.jsx)(n.N_,{to:"#",className:"btn btn-link btn-lg text-muted shadow-none",children:(0,c.jsx)("i",{className:"dripicons-cross",onClick:()=>(a=>{const n=[...s];n.splice(a,1),t(n),e.onFileUpload&&e.onFileUpload(n)})(o)})})})]})})},o+"-file")))})]})};d.defaultProps={showPreview:!0};const m=d},92213:(e,s,t)=>{t.r(s),t.d(s,{default:()=>k});var a=t(9950),n=t(56035),i=t(86781),r=t(68459),l=t(64055),o=t(90729),c=t(584),d=t(97937),m=t(86133),h=t(82612),p=t(63112),u=t(26473),x=t(60666),j=t(70030),b=t(9449),g=t(27081),w=t(28429),y=t(42074),N=t(19443),v=t(80183),f=t(49462),A=t(80730),S=t(32393),_=t(88249),C=t(44414);const D=()=>{const{t:e}=(0,j.B)(),s=(0,u.t)(x.Ik().shape({title:x.Yj().required(e("Please select title")).min(10,"Atleast 10 char required")})),[t,m]=(0,a.useState)(!1),[D,k]=(0,a.useState)(""),[F,T]=(0,a.useState)(null),[I,M]=(0,a.useState)(""),B=(0,g.wA)(),{flats:Z,users:P}=(0,g.d4)((e=>({flats:e.Flat.flats,users:e.User.users}))),O=(0,w.g)();(0,a.useEffect)((()=>{B((0,N.qx)()).then((()=>{B((0,v.mX)(1)).then((()=>{B((0,f.an)(O.id)).unwrap().then((e=>{T(e),Y("id",e.id),Y("title",e.title),Y("description",e.description),"number"===typeof e.inspection_by&&Y("inspection_by",e.inspection_by),Y("flat_id",e.flat_id),Y("status",e.status.toString()),Y("priority",e.priority.toString()),Y("notes",e.notes),Y("inspection_date",e.inspection_date),H(new Date(e.inspection_date))})).catch((e=>M(e)))}))}))}),[O.id]);const{register:U,handleSubmit:z,setValue:Y,setError:E,control:L,formState:{errors:R}}=(0,b.mN)({defaultValues:{},resolver:s}),q=z((async e=>{m(!0),await B((0,f.MA)(e)).unwrap().then((e=>{e&&!0===e.status&&(k(e.message),window.scrollTo({top:0,behavior:"smooth"})),m(!1)})).catch((e=>{for(var s in e.errors)try{s.includes("documents")?[...Array(10)].map(((s,t)=>E("documents",{message:e.errors["documents."+t].toString()}))):E(s,{message:e.errors[s].toString()})}catch(t){}m(!1)}))})),[G,H]=(0,a.useState)(new Date);return(0,C.jsxs)(C.Fragment,{children:[D&&(0,C.jsxs)("div",{className:"alert alert-success",children:[D,(0,C.jsx)(y.N_,{to:"/inspection",children:" Back to Inspection."})]}),I&&(0,C.jsx)("div",{className:"alert alert-danger mt-3",role:"alert",children:I}),(0,C.jsx)(n.A,{children:(0,C.jsx)(n.A.Body,{children:(0,C.jsx)(i.A,{children:(0,C.jsx)(r.A,{lg:6,children:(0,C.jsxs)("form",{onSubmit:q,children:[(0,C.jsx)(h.Z,{type:"hidden",name:"id"}),(0,C.jsx)(h.Z,{label:"Title",type:"text",register:U,name:"title",errors:R,containerClass:"mb-3"},"title"),(0,C.jsx)(h.Z,{label:"Description",type:"textarea",register:U,name:"description",errors:R,rows:"3",containerClass:"mb-3"},"description"),(0,C.jsx)(h.Z,{type:"hidden",register:U,name:"inspection_date",value:G.toISOString().split("T")[0]},"inspection_date"),(0,C.jsxs)("div",{className:"mb-3",children:[(0,C.jsx)("label",{className:"form-label",children:"Inspection Date"})," ",(0,C.jsx)("br",{}),(0,C.jsx)(p.A,{value:G,minDate:new Date,showTimeSelect:!0,dateFormat:"MM-dd-yyyy HH:mm",onChange:e=>{H(e),Y("inspection_date",e.toLocaleString("sv-SE"))}})]}),(0,C.jsx)(i.A,{children:(0,C.jsxs)(l.A.Group,{className:"mb-3 input-group",children:[(0,C.jsx)(o.A,{className:"me-2",children:"Priority"}),(0,C.jsx)(h.Z,{type:"radio",className:"form-check-inline",name:"priority",label:"Low",value:1,register:U,id:"priorty_low",defaultChecked:!0},"priorty_low"),(0,C.jsx)(h.Z,{type:"radio",className:"form-check-inline",name:"priority",label:"Medium",value:2,register:U,id:"priorty_medium"},"priorty_medium"),(0,C.jsx)(h.Z,{type:"radio",className:"form-check-inline",name:"priority",label:"High",value:3,register:U,id:"priorty_high"},"priorty_high")]})}),(0,C.jsxs)(i.A,{children:[(0,C.jsxs)(l.A.Group,{className:"mb-3 input-group",children:[(0,C.jsx)(o.A,{className:"me-2",children:"Status"}),(0,C.jsx)(h.Z,{type:"radio",className:"form-check-inline",name:"status",label:"Open",value:1,id:"status_open",register:U,defaultChecked:!0},"status_open"),(0,C.jsx)(h.Z,{type:"radio",className:"form-check-inline",name:"status",label:"In Progress",value:2,id:"status_progress",register:U},"status_progress"),(0,C.jsx)(h.Z,{type:"radio",className:"form-check-inline",name:"status",label:"Close",value:3,id:"status_close",register:U},"status_close")]}),(0,C.jsx)(h.Z,{type:"select",label:"Suite",name:"flat_id",containerClass:"mb-3 ",register:U,errors:R,children:Z.length&&Z.map((e=>(0,C.jsx)("optgroup",{label:e.name.toString(),children:e.flats.map((e=>(0,C.jsx)("option",{value:e.id,children:e.name},"flat"+e.id)))},`apartment${e.id}`)))}),R&&R.flat_id?(0,C.jsx)(l.A.Control.Feedback,{type:"invalid",children:R.flat_id.message}):null,(0,C.jsx)(h.Z,{type:"select",label:"Assign To",name:"inspection_by",containerClass:"mb-3 ",register:U,errors:R,children:P?P.data.length&&P.data.map((e=>(0,C.jsxs)("option",{value:e.user.id.toString(),children:[e.user.name," - ",e.user.role]},"user"+e.user.id))):(0,C.jsx)("option",{})}),R&&R.inspection_by?(0,C.jsx)(l.A.Control.Feedback,{type:"invalid",children:R.inspection_by.message}):null,(0,C.jsx)(h.Z,{label:"Notes",type:"textarea",register:U,name:"notes",errors:R,rows:"3",containerClass:"mb-3"},"notes"),(0,C.jsx)(o.A,{className:"",children:"Documents"}),null===F||void 0===F?void 0:F.documents.map((e=>(0,C.jsx)("div",{children:(0,C.jsx)(n.A,{className:"mt-1 mb-1 shadow-none border",children:(0,C.jsx)("div",{className:"p-2",children:(0,C.jsxs)(i.A,{className:"align-items-center",children:[(0,C.jsx)(r.A,{className:"ps-0 ms-2",children:(0,C.jsx)(y.N_,{to:`${S.A.BASE_URL}/${e.document_path}`,className:"text-muted fw-bold",target:"_blank",children:e.document_name})}),(0,C.jsx)(r.A,{className:"text-end",children:(0,C.jsx)(y.N_,{to:"#",className:"btn btn-link btn-lg text-muted shadow-none",children:(0,C.jsx)("i",{className:"dripicons-cross",onClick:()=>{B((0,f.VJ)(e.id)).unwrap().then((e=>{e&&e.status&&B((0,f.an)(O.id)).unwrap().then((e=>{T(e)}))}))}})})})]})})},e.id+"-file")}))),(0,C.jsxs)(c.A,{children:[(0,C.jsx)(b.xI,{render:()=>(0,C.jsx)(A.A,{maxFiles:10,onFileUpload:e=>{Y("documents",e)}}),name:"documents",control:L}),R&&R.documents?(0,C.jsx)(l.A.Text,{className:"text-danger",children:R.documents.message}):null]})]}),t?(0,C.jsx)(_.m,{}):(0,C.jsx)(d.A,{variant:"primary",type:"submit",children:"Create"})]})})})})})]})},k=()=>(0,C.jsxs)(a.Fragment,{children:[(0,C.jsx)(m.A,{breadCrumbItems:[{label:"Dashboard",path:"/dashboard-2"},{label:"Maintanance Inspections",path:"/inspection"},{label:"Maintanance Inspection",path:"/inspection/new",active:!0}],title:"Maintanance Inspection"}),(0,C.jsx)(i.A,{children:(0,C.jsx)(r.A,{children:(0,C.jsx)(D,{})})})]})}}]);