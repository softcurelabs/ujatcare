"use strict";(self.webpackChunkujatcare=self.webpackChunkujatcare||[]).push([[3619],{63112:(e,s,t)=>{t.d(s,{A:()=>i});var a=t(72348),l=t.n(a),n=(t(4434),t(44414));const i=e=>(0,n.jsx)(n.Fragment,{children:e.showTimeSelectOnly?(0,n.jsx)(l(),{name:e.name,timeIntervals:e.tI,selected:e.value,onChange:s=>e.onChange(s),showTimeSelect:e.showTimeSelect,timeFormat:"hh:mm a",timeCaption:e.timeCaption,dateFormat:"hh:mm",className:"form-control",minDate:e.minDate,scrollableYearDropdown:!0,scrollableMonthYearDropdown:!0,maxDate:e.maxDate,disabled:e.disabled,monthsShown:e.monthsShown,wrapperClassName:"is-invalid",showTimeSelectOnly:e.showTimeSelectOnly,inline:e.inline,autoComplete:"off"}):(0,n.jsx)(l(),{name:e.name,timeIntervals:e.tI,selected:e.value,onChange:s=>e.onChange(s),showTimeSelect:e.showTimeSelect,timeFormat:"hh:mm a",timeCaption:e.timeCaption,dateFormat:e.dateFormat,minDate:e.minDate,disabled:e.disabled,wrapperClassName:"is-invalid",className:"form-control",maxDate:e.maxDate,showMonthDropdown:!0,showYearDropdown:!0,scrollableMonthYearDropdown:!0,monthsShown:e.monthsShown,showTimeSelectOnly:e.showTimeSelectOnly,inline:e.inline,autoComplete:"off"})})},63790:(e,s,t)=>{t.d(s,{A:()=>c});var a=t(9950),l=t(42074),n=t(48738),i=t.n(n),r=t(44414);const c=e=>{let{tableProps:s,sizePerPageList:t}=e;const[n,c]=(0,a.useState)(s.pageCount),[o,d]=(0,a.useState)(s.state.pageIndex);(0,a.useEffect)((()=>{c(s.pageCount),d(s.state.pageIndex)}),[s.pageCount,s.state.pageIndex]);const m=(0,a.useCallback)(((e,s)=>e.filter((e=>e<=n))),[n]),h=(0,a.useCallback)(((e,s)=>s<7?m([1,2,3,4,5,6],s):e%5>=0&&e>4&&e+2<s?[1,e-1,e,e+1,s]:e%5>=0&&e>4&&e+2>=s?[1,s-3,s-2,s-1,s]:[1,2,3,4,5,s]),[m]),u=e=>{if(e===o)return;const t=h(e,n);j(m(t,n)),s.gotoPage(e)};(0,a.useEffect)((()=>{const e=h(null,n);j(e)}),[n,h]);const[x,j]=(0,a.useState)(h(null,n)),g=o;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"d-lg-flex align-items-center text-center pb-1",children:[t.length>0&&(0,r.jsxs)("div",{className:"d-inline-block me-3",children:[(0,r.jsx)("label",{className:"me-1",children:"Display :"}),(0,r.jsx)("select",{value:s.state.pageSize,onChange:e=>{s.setPageSize(Number(e.target.value))},className:"form-select d-inline-block w-auto",children:(t||[]).map(((e,s)=>(0,r.jsx)("option",{value:e.value,children:e.text},s)))})]}),(0,r.jsxs)("span",{className:"me-3",children:["Page"," ",(0,r.jsxs)("strong",{children:[o," of ",s.pageOptions.length]})," "]}),(0,r.jsxs)("ul",{className:"pagination pagination-rounded d-inline-flex ms-auto align-item-center mb-0",children:[(0,r.jsx)("li",{className:i()("page-item","paginate_button","previous",{disabled:1===g}),onClick:()=>{1!==g&&u(g-1)},children:(0,r.jsx)(l.N_,{to:"#",className:"page-link",children:(0,r.jsx)("i",{className:"mdi mdi-chevron-left"})})},"prevpage"),(x||[]).map(((e,s,t)=>t[s-1]+1<e?(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)("li",{className:"page-item disabled d-none d-xl-inline-block",children:(0,r.jsx)(l.N_,{to:"#",className:"page-link",children:"..."})}),(0,r.jsx)("li",{className:i()("page-item","d-none","d-xl-inline-block",{active:g===e}),onClick:s=>u(e),children:(0,r.jsx)(l.N_,{to:"#",className:"page-link",children:e})})]},e):(0,r.jsx)("li",{className:i()("page-item","d-none","d-xl-inline-block",{active:g===e}),onClick:s=>u(e),children:(0,r.jsx)(l.N_,{to:"#",className:"page-link",children:e})},e))),(0,r.jsx)("li",{className:i()("page-item","paginate_button","next",{disabled:g===s.pageCount}),onClick:()=>{g!==s.pageCount&&u(g+1)},children:(0,r.jsx)(l.N_,{to:"#",className:"page-link",children:(0,r.jsx)("i",{className:"mdi mdi-chevron-right"})})},"nextpage")]})]})})}},83619:(e,s,t)=>{t.r(s),t.d(s,{default:()=>T});var a=t(9950),l=t(42074),n=t(86781),i=t(68459),r=t(471),c=t(97937),o=t(1093),d=t(48738),m=t.n(d),h=t(86133),u=t(27081),x=t(41757),j=t(94166),g=t(63790),p=t(44268),N=t(64055),b=t(60666),v=t(26473),f=t(68984),w=t(9449),S=t(88249),C=t(63112),k=t(44414);const A=e=>{let{users:s,show:t,onHide:l,onSubmit:n}=e;const i=(0,v.t)(b.Ik().shape({})),[r,o]=(0,a.useState)(new Date),d=(0,u.wA)(),[m,h]=(0,a.useState)(""),[j,g]=(0,a.useState)(!1),[A,_]=(0,a.useState)("");(0,a.useEffect)((()=>{_(""),h("")}),[t]);const{register:y,handleSubmit:D,setValue:I,setError:F,reset:T,control:P,formState:{errors:E}}=(0,w.mN)({defaultValues:{},resolver:i}),H=D((e=>{g(!0),h(""),_(""),d((0,x.Bw)(e)).unwrap().then((e=>{e&&!0===e.status&&(h(e.message),_(e.errors),T()),g(!1)})).catch((e=>{_(e.message),h(""),g(!1)}))}));return(0,k.jsxs)(p.A,{show:t,onHide:l,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,dialogClassName:"modal-lg",children:[(0,k.jsx)(p.A.Header,{className:"bg-light",onHide:l,closeButton:!0,children:(0,k.jsx)(p.A.Title,{className:"m-0",children:"Create a Invoice"})}),(0,k.jsxs)(p.A.Body,{className:"p-4",children:[m&&(0,k.jsx)("div",{className:"alert alert-success",children:m}),A&&(0,k.jsx)("div",{className:"alert alert-danger mt-3",role:"alert",dangerouslySetInnerHTML:{__html:A}}),(0,k.jsxs)("form",{onSubmit:H,children:[(0,k.jsx)(f.Z,{label:"Tenants",type:"select",name:"tenant",className:"form-control-sm fs-5",containerClass:"mb-3",register:y,errors:E,children:s.map((e=>(0,k.jsxs)("option",{value:e.user.id.toString(),children:[e.user.name," - ",e.user.flat_name,"(",e.user.apartment_name,")"]})))},"tenants"),(0,k.jsxs)("div",{className:"mb-3",children:[(0,k.jsx)("label",{className:"form-label",children:"Due Date"})," ",(0,k.jsx)("br",{}),(0,k.jsx)(C.A,{hideAddon:!0,showTimeSelect:!1,minDate:new Date,value:r,onChange:e=>{o(e),I("due_date",e.toLocaleString("sv-SE"))}}),E&&E.due_date?(0,k.jsx)(N.A.Control.Feedback,{type:"invalid",children:E.due_date.message}):null]}),(0,k.jsx)(f.Z,{label:"Item Description",type:"text",name:"title",className:"form-control-sm fs-5",containerClass:"mb-3",register:y,errors:E},"title"),(0,k.jsx)(f.Z,{label:"Total",type:"text",name:"total",className:"form-control-sm fs-5",containerClass:"mb-3",register:y,errors:E},"total"),(0,k.jsxs)("div",{className:"text-end mt-2",children:[j?(0,k.jsx)(S.m,{}):(0,k.jsx)(c.A,{variant:"success",type:"submit",className:"waves-effect waves-light me-1",children:"Create"}),(0,k.jsx)(c.A,{variant:"danger",className:"waves-effect waves-light",onClick:l,children:"Exit"})]})]})]})]})};var _=t(80183),y=t(96105);const D=e=>{let{row:s}=e;return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)("h5",{children:(0,k.jsxs)("span",{className:m()("badge",{"bg-soft-success text-success":"2"==s.status,"bg-soft-danger text-danger":"1"==s.status,"bg-soft-info text-info":"0"==s.status}),children:["2"==s.status&&(0,k.jsx)("i",{className:"mdi mdi-bitcoin me-1"}),"1"==s.status&&(0,k.jsx)("i",{className:"mdi mdi-cancel me-1"}),"0"==s.status&&(0,k.jsx)("i",{className:"mdi mdi-cash me-1"}),j.n[s.status]]})})})},I=e=>{let{row:s}=e;return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)("h5",{children:(0,k.jsx)("span",{className:m()("badge",{"bg-success":null!==s.quickbook_id,"bg-warning":null===s.quickbook_id}),children:s.quickbook_id?"Syced":"Not Synced"})})})},F=e=>{let{row:s,deleteInvoice:t}=e;const a=(0,u.wA)();let{user:n,customerUser:i}=(0,u.d4)((e=>({user:e.Auth.user,customerUser:e.CustomerAuth.user})));n||(n=i);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(l.N_,{to:"/invoice/".concat(s.id),className:"action-icon",children:[" ",(0,k.jsx)("i",{className:"mdi mdi-eye"})]}),(0,k.jsx)(k.Fragment,{children:n.user_role.includes("admin")||n.user_role.includes("staff")?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(l.N_,{to:"/invoice-edit/".concat(s.id),className:"action-icon",children:[" ",(0,k.jsx)("i",{className:"mdi mdi-square-edit-outline"})]}),(0,k.jsxs)(l.N_,{to:"#",className:"action-icon",onClick:()=>t(s.id),children:[" ",(0,k.jsx)("i",{className:"mdi mdi-delete"})]}),(0,k.jsxs)(l.N_,{to:"#",onClick:()=>{return e=s.id,void a((0,x.Rs)(e));var e},"aria-disabled":!0,className:"action-icon",title:"Sync with Quickbook",children:[" ",(0,k.jsx)("i",{className:"mdi mdi-sync"})]})]}):(0,k.jsx)(k.Fragment,{})})]})},T=()=>{const[e,s]=(0,a.useState)(""),[t,d]=(0,a.useState)(""),[m,p]=(0,a.useState)(0),[N,b]=(0,a.useState)(!1),[v,f]=(0,a.useState)(""),w=(0,u.wA)(),[S,C]=(0,a.useState)(1),{invoice:T,users:P,refresh:E,message:H,status:O}=(0,u.d4)((e=>({invoice:e.Invoice.invoice,users:e.User.occupants,refresh:e.Invoice.refresh,message:e.Invoice.message,status:e.Invoice.status}))),[B,U]=(0,a.useState)(!1);let{user:L,customerUser:M}=(0,u.d4)((e=>({user:e.Auth.user,customerUser:e.CustomerAuth.user})));L||(L=M),(0,a.useEffect)((()=>{(L.user_role.includes("admin")||L.user_role.includes("staff"))&&w((0,_.hW)())}),[]),(0,a.useEffect)((()=>{w((0,x.gP)({page:S,filter:v}))}),[S,v,E,B,N]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(h.A,{breadCrumbItems:[{label:"Rent history",path:"/invoice",active:!0}],title:"Rent History"}),(0,k.jsx)(n.A,{children:(0,k.jsx)(i.A,{children:(0,k.jsx)(r.A,{children:(0,k.jsxs)(r.A.Body,{children:[O&&(0,k.jsx)("div",{className:"alert alert-success",children:H}),!O&&H&&(0,k.jsx)("div",{className:"alert alert-danger mt-3",role:"alert",dangerouslySetInnerHTML:{__html:H}}),(0,k.jsxs)(n.A,{className:"align-items-center",children:[(0,k.jsx)(i.A,{lg:8,children:(0,k.jsx)("form",{className:"row gy-2 gx-2 align-items-center justify-content-lg-start justify-content-between",children:(0,k.jsx)("div",{className:"col-auto",children:(0,k.jsxs)("div",{className:"d-flex align-items-center w-auto",children:[(0,k.jsx)("label",{htmlFor:"status-select",className:"me-2",children:"Status"}),(0,k.jsxs)("select",{className:"form-select",id:"status-select",onChange:e=>{return s=e.target.value,void f(s);var s},children:[(0,k.jsx)("option",{value:"",children:"All"}),Object.keys(j.n).map((e=>(0,k.jsx)("option",{value:e,children:j.n[e]},"status".concat(e))))]})]})})})}),(0,k.jsx)(i.A,{lg:4,children:(0,k.jsx)("div",{className:"text-lg-end mt-xl-0 mt-2",children:L.user_role.includes("admin")||L.user_role.includes("staff")?(0,k.jsxs)(c.A,{className:"btn  mb-2 me-2",onClick:()=>U(!0),children:[(0,k.jsx)("i",{className:"mdi mdi-basket me-1"})," Create a Invoice"]}):(0,k.jsx)(k.Fragment,{})})})]}),(0,k.jsx)(r.A,{children:(0,k.jsxs)(r.A.Body,{children:[e&&(0,k.jsx)("div",{className:"alert alert-success",children:e}),t&&(0,k.jsx)("div",{className:"alert alert-danger mt-3",role:"alert",children:t}),(0,k.jsx)("div",{className:"table-responsive",children:(0,k.jsxs)(o.A,{className:"table table-centered react-table dt-responsive nowrap w-100",children:[(0,k.jsx)("thead",{className:"table-light",children:(0,k.jsxs)("tr",{children:[(0,k.jsx)("th",{children:"ID"}),(0,k.jsx)("th",{children:"Suite"}),(0,k.jsx)("th",{children:"Status"}),(0,k.jsx)("th",{children:"Due Date"}),(0,k.jsx)("th",{children:"Created At"}),(0,k.jsx)("th",{children:"QuickBook Status"}),(0,k.jsx)("th",{children:"Actions"})]})}),(0,k.jsx)("tbody",{children:T&&T.data.length>0?T.data.map(((e,s)=>{var t,a,n;return(0,k.jsxs)("tr",{role:"row",children:[(0,k.jsx)("td",{role:"cell",children:(0,k.jsxs)(l.N_,{to:"/invoice/".concat(e.id),className:"text-body fw-bold",children:["#",e.id]})}),(0,k.jsxs)("td",{role:"cell",children:[null===(t=e.flat)||void 0===t?void 0:t.name," - ",null===(a=e.flat)||void 0===a||null===(n=a.apartment)||void 0===n?void 0:n.name]}),(0,k.jsx)("td",{role:"cell",children:(0,k.jsx)(D,{row:e})}),(0,k.jsx)("td",{role:"cell",children:e.due_date}),(0,k.jsx)("td",{role:"cell",children:e.created_at}),(0,k.jsx)("td",{role:"cell",children:(0,k.jsx)(I,{row:e})}),(0,k.jsx)("td",{role:"cell",children:(0,k.jsx)(F,{row:e,deleteInvoice:e=>{b(!0),p(e)}})})]},s)})):(0,k.jsx)("p",{children:"No Data Found"})})]})}),T&&(0,k.jsx)(g.A,{tableProps:{pageCount:T.last_page,state:{pageIndex:T.current_page},pageOptions:{length:T.total},gotoPage:e=>{C(e)}},sizePerPageList:[{text:"10",value:10}]})]})}),P&&(0,k.jsx)(y.m,{title:"Are you sure you want to delete invoice?",show:N,targetId:m,submitForm:e=>{s(""),d(""),w((0,x.bb)(e)).unwrap().then((e=>{e&&!0===e.status&&(s(e.message),b(!1))})).catch((e=>{d(e.message),b(!1)}))},handleClose:()=>b(!1)}),P&&(0,k.jsx)(A,{users:P,show:B,onHide:()=>{U(!1)},onSubmit:()=>{}})]})})})})]})}},94166:(e,s,t)=>{t.d(s,{n:()=>a});const a={0:"Unpaid",1:"Payment Failed",2:"Paid"}}}]);