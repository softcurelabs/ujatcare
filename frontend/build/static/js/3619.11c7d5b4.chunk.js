"use strict";(self.webpackChunkujatcare=self.webpackChunkujatcare||[]).push([[3619],{63647:(e,s,a)=>{a.d(s,{m:()=>n});var t=a(95252),l=a(44414);const n=()=>(0,l.jsx)(t.A,{animation:"border",role:"status",children:(0,l.jsx)("span",{className:"visually-hidden",children:"Loading..."})})},96105:(e,s,a)=>{a.d(s,{m:()=>r});var t=a(44268),l=a(97937),n=a(44414);const r=e=>{let{okLabel:s="OK",cancelLabel:a="Cancel",title:r="Confirmation",submitForm:i,show:c,targetId:o,handleClose:d}=e;return(0,n.jsxs)(t.A,{show:c,onHide:d,children:[(0,n.jsx)(t.A.Header,{closeButton:!0,children:(0,n.jsx)(t.A.Title,{children:r})}),(0,n.jsx)(t.A.Body,{children:"Do you really want to submit?"}),(0,n.jsxs)(t.A.Footer,{children:[(0,n.jsx)(l.A,{variant:"secondary",onClick:d,children:a}),(0,n.jsx)(l.A,{variant:"primary",onClick:()=>i(o),children:s})]})]})}},63112:(e,s,a)=>{a.d(s,{A:()=>r});var t=a(72348),l=a.n(t),n=(a(4434),a(44414));const r=e=>(0,n.jsx)(n.Fragment,{children:e.showTimeSelectOnly?(0,n.jsx)(l(),{name:e.name,timeIntervals:e.tI,selected:e.value,onChange:s=>e.onChange(s),showTimeSelect:e.showTimeSelect,timeFormat:"hh:mm a",timeCaption:e.timeCaption,dateFormat:"hh:mm",className:"form-control "+e.inputClass,minDate:e.minDate,scrollableYearDropdown:!0,scrollableMonthYearDropdown:!0,maxDate:e.maxDate,disabled:e.disabled,monthsShown:e.monthsShown,wrapperClassName:"is-invalid",showTimeSelectOnly:e.showTimeSelectOnly,inline:e.inline,autoComplete:"off"}):(0,n.jsx)(l(),{name:e.name,timeIntervals:e.tI,selected:e.value,onChange:s=>e.onChange(s),showTimeSelect:e.showTimeSelect,timeFormat:"hh:mm a",timeCaption:e.timeCaption,dateFormat:e.dateFormat,minDate:e.minDate,disabled:e.disabled,wrapperClassName:"is-invalid",className:"form-control "+e.inputClass,maxDate:e.maxDate,showMonthDropdown:!0,showYearDropdown:!0,scrollableMonthYearDropdown:!0,monthsShown:e.monthsShown,showTimeSelectOnly:e.showTimeSelectOnly,inline:e.inline,autoComplete:"off"})})},41033:(e,s,a)=>{a.d(s,{A:()=>i});a(9950);var t=a(86781),l=a(68459),n=a(81924),r=a(44414);const i=e=>(0,r.jsx)(t.A,{children:(0,r.jsx)(l.A,{children:(0,r.jsxs)("div",{className:"page-title-box",children:[(0,r.jsx)("div",{children:(0,r.jsxs)(n.A,{className:"m-0 mb-0",children:[(0,r.jsx)(n.A.Item,{href:"/",children:"Home"}),(e.breadCrumbItems||[]).map(((e,s)=>e.active?(0,r.jsx)(n.A.Item,{active:!0,children:e.label},s):(0,r.jsx)(n.A.Item,{href:e.path,children:e.label},s)))]})}),(0,r.jsx)("h4",{className:"page-title",children:e.title})]})})})},63790:(e,s,a)=>{a.d(s,{A:()=>c});var t=a(9950),l=a(42074),n=a(48738),r=a.n(n),i=a(44414);const c=e=>{let{tableProps:s,sizePerPageList:a}=e;const[n,c]=(0,t.useState)(s.pageCount),[o,d]=(0,t.useState)(s.state.pageIndex);(0,t.useEffect)((()=>{c(s.pageCount),d(s.state.pageIndex)}),[s.pageCount,s.state.pageIndex]);const m=(0,t.useCallback)(((e,s)=>e.filter((e=>e<=n))),[n]),h=(0,t.useCallback)(((e,s)=>s<7?m([1,2,3,4,5,6],s):e%5>=0&&e>4&&e+2<s?[1,e-1,e,e+1,s]:e%5>=0&&e>4&&e+2>=s?[1,s-3,s-2,s-1,s]:[1,2,3,4,5,s]),[m]),u=e=>{if(e===o)return;const a=h(e,n);j(m(a,n)),s.gotoPage(e)};(0,t.useEffect)((()=>{const e=h(null,n);j(e)}),[n,h]);const[x,j]=(0,t.useState)(h(null,n)),p=o;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"d-lg-flex align-items-center text-center pb-1",children:[a.length>0&&(0,i.jsxs)("div",{className:"d-inline-block me-3",children:[(0,i.jsx)("label",{className:"me-1",children:"Display :"}),(0,i.jsx)("select",{value:s.state.pageSize,onChange:e=>{s.setPageSize(Number(e.target.value))},className:"form-select d-inline-block w-auto",children:(a||[]).map(((e,s)=>(0,i.jsx)("option",{value:e.value,children:e.text},s)))})]}),(0,i.jsxs)("span",{className:"me-3",children:["Page"," ",(0,i.jsxs)("strong",{children:[o," of ",s.pageOptions.length]})," "]}),(0,i.jsxs)("ul",{className:"pagination pagination-rounded d-inline-flex ms-auto align-item-center mb-0",children:[(0,i.jsx)("li",{className:r()("page-item","paginate_button","previous",{disabled:1===p}),onClick:()=>{1!==p&&u(p-1)},children:(0,i.jsx)(l.N_,{to:"#",className:"page-link",children:(0,i.jsx)("i",{className:"mdi mdi-chevron-left"})})},"prevpage"),(x||[]).map(((e,s,a)=>a[s-1]+1<e?(0,i.jsxs)(t.Fragment,{children:[(0,i.jsx)("li",{className:"page-item disabled d-none d-xl-inline-block",children:(0,i.jsx)(l.N_,{to:"#",className:"page-link",children:"..."})}),(0,i.jsx)("li",{className:r()("page-item","d-none","d-xl-inline-block",{active:p===e}),onClick:s=>u(e),children:(0,i.jsx)(l.N_,{to:"#",className:"page-link",children:e})})]},e):(0,i.jsx)("li",{className:r()("page-item","d-none","d-xl-inline-block",{active:p===e}),onClick:s=>u(e),children:(0,i.jsx)(l.N_,{to:"#",className:"page-link",children:e})},e))),(0,i.jsx)("li",{className:r()("page-item","paginate_button","next",{disabled:p===s.pageCount}),onClick:()=>{p!==s.pageCount&&u(p+1)},children:(0,i.jsx)(l.N_,{to:"#",className:"page-link",children:(0,i.jsx)("i",{className:"mdi mdi-chevron-right"})})},"nextpage")]})]})})}},68984:(e,s,a)=>{a.d(s,{Z:()=>h,z:()=>r});var t=a(9950),l=a(9449),n=a(44414);const r=e=>{let{defaultValues:s,resolver:a,children:r,onSubmit:i,formClass:c}=e;const o=(0,l.mN)({defaultValues:s,resolver:a}),{handleSubmit:d,register:m,control:h,formState:{errors:u}}=o;return(0,n.jsx)("form",{onSubmit:d(i),className:c,noValidate:!0,children:Array.isArray(r)?r.map((e=>e.props&&e.props.name?t.createElement(e.type,{...{...e.props,register:m,key:e.props.name,errors:u,control:h}}):e)):r})};var i=a(75623),c=a(64055),o=a(48738),d=a.n(o);const m=e=>{let{name:s,placeholder:a,refCallback:l,errors:r,control:o,register:m,className:h}=e;const[u,x]=(0,t.useState)(!1);return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(i.A,{className:"mb-0",children:[(0,n.jsx)(c.A.Control,{type:u?"text":"password",placeholder:a,name:s,id:s,as:"input",ref:e=>{l&&l(e)},className:h,isInvalid:!(!r||!r[s]),...m?m(s):{},autoComplete:s}),(0,n.jsx)("div",{className:d()("input-group-text","input-group-password",{"show-password":u}),"data-password":u?"true":"false",children:(0,n.jsx)("span",{className:"password-eye",onClick:()=>{x(!u)}})})]})})},h=e=>{let{label:s,type:a,name:t,placeholder:l,register:r,errors:i,control:o,className:d,labelClassName:h,containerClass:u,refCallback:x,children:j,rows:p,symbol:g,...b}=e;const N="textarea"===a?"textarea":"select"===a?"select":"input";return(0,n.jsx)(n.Fragment,{children:"hidden"===a?(0,n.jsx)("input",{type:a,name:t,id:t,...r?r(t):{},...b,className:d}):(0,n.jsx)(n.Fragment,{children:"password"===a?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(c.A.Group,{className:u,children:[s?(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsx)(c.A.Label,{className:h,children:s})," ",j," "]}):null,(0,n.jsx)(m,{name:t,placeholder:l,refCallback:x,errors:i,register:r,className:d}),i&&i[t]?(0,n.jsx)(c.A.Control.Feedback,{type:"invalid",className:"d-block",children:i[t].message}):null]})}):(0,n.jsx)(n.Fragment,{children:"checkbox"===a||"radio"===a?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(c.A.Group,{className:u,children:[(0,n.jsx)(c.A.Check,{type:a,label:s,name:t,id:t,ref:e=>{x&&x(e)},className:d,isInvalid:!(!i||!i[t]),...r?r(t):{},...b}),i&&i[t]?(0,n.jsx)(c.A.Control.Feedback,{type:"invalid",children:i[t].message}):null]})}):(0,n.jsxs)(c.A.Group,{className:u,children:[s?(0,n.jsx)(c.A.Label,{className:h,children:s}):null,g?(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("span",{className:"input-group-text",id:t,children:g}),(0,n.jsx)(c.A.Control,{type:a,placeholder:l,name:t,id:t,as:N,ref:e=>{x&&x(e)},className:d,isInvalid:!(!i||!i[t]),...r?r(t):{},rows:p,...b,autoComplete:t,children:j||null})]}):(0,n.jsx)(c.A.Control,{type:a,placeholder:l,name:t,id:t,as:N,ref:e=>{x&&x(e)},className:d,isInvalid:!(!i||!i[t]),...r?r(t):{},rows:p,...b,autoComplete:t,children:j||null}),i&&i[t]?(0,n.jsx)(c.A.Control.Feedback,{type:"invalid",children:i[t].message}):null]})})})})}},83619:(e,s,a)=>{a.r(s),a.d(s,{default:()=>T});var t=a(9950),l=a(42074),n=a(86781),r=a(68459),i=a(471),c=a(97937),o=a(1093),d=a(48738),m=a.n(d),h=a(41033),u=a(27081),x=a(41757),j=a(94166),p=a(63790),g=a(44268),b=a(64055),N=a(60666),v=a(26473),f=a(68984),w=a(9449),C=a(63647),A=a(63112),y=a(44414);const k=e=>{let{users:s,show:a,onHide:l,onSubmit:n}=e;const r=(0,v.t)(N.Ik().shape({})),[i,o]=(0,t.useState)(new Date),d=(0,u.wA)(),[m,h]=(0,t.useState)(""),[j,p]=(0,t.useState)(!1),[k,S]=(0,t.useState)("");(0,t.useEffect)((()=>{S(""),h("")}),[a]);const{register:_,handleSubmit:F,setValue:I,setError:D,reset:T,control:P,formState:{errors:H}}=(0,w.mN)({defaultValues:{},resolver:r}),L=F((e=>{p(!0),h(""),S(""),d((0,x.Bw)(e)).unwrap().then((e=>{e&&!0===e.status&&(h(e.message),S(e.errors),T()),p(!1)})).catch((e=>{S(e.message),h(""),p(!1)}))}));return(0,y.jsxs)(g.A,{show:a,onHide:l,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,dialogClassName:"modal-lg",children:[(0,y.jsx)(g.A.Header,{className:"bg-light",onHide:l,closeButton:!0,children:(0,y.jsx)(g.A.Title,{className:"m-0",children:"Create a Invoice"})}),(0,y.jsxs)(g.A.Body,{className:"p-4",children:[m&&(0,y.jsx)("div",{className:"alert alert-success",children:m}),k&&(0,y.jsx)("div",{className:"alert alert-danger mt-3",role:"alert",dangerouslySetInnerHTML:{__html:k}}),(0,y.jsxs)("form",{onSubmit:L,children:[(0,y.jsx)(f.Z,{label:"Tenants",type:"select",name:"tenant",className:"form-control-sm fs-5",containerClass:"mb-3",register:_,errors:H,children:s.map((e=>(0,y.jsxs)("option",{value:e.user.id.toString(),children:[e.user.name," - ",e.user.flat_name,"(",e.user.apartment_name,")"]})))},"tenants"),(0,y.jsxs)("div",{className:"mb-3",children:[(0,y.jsx)("label",{className:"form-label",children:"Due Date"})," ",(0,y.jsx)("br",{}),(0,y.jsx)(A.A,{hideAddon:!0,showTimeSelect:!1,minDate:new Date,value:i,onChange:e=>{o(e),I("due_date",e.toLocaleString("sv-SE"))}}),H&&H.due_date?(0,y.jsx)(b.A.Control.Feedback,{type:"invalid",children:H.due_date.message}):null]}),(0,y.jsx)(f.Z,{label:"Item Description",type:"text",name:"title",className:"form-control-sm fs-5",containerClass:"mb-3",register:_,errors:H},"title"),(0,y.jsx)(f.Z,{label:"Amount",type:"text",name:"total",symbol:"$",className:"form-control-sm fs-5",containerClass:"mb-3",register:_,errors:H},"total"),(0,y.jsxs)("div",{className:"text-end mt-2",children:[j?(0,y.jsx)(C.m,{}):(0,y.jsx)(c.A,{variant:"success",type:"submit",className:"waves-effect waves-light me-1",children:"Create"}),(0,y.jsx)(c.A,{variant:"danger",className:"waves-effect waves-light",onClick:l,children:"Exit"})]})]})]})]})};var S=a(80183),_=a(96105);const F=e=>{let{row:s}=e;return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)("h5",{children:(0,y.jsxs)("span",{className:m()("badge",{"bg-soft-success text-success":"2"==s.status,"bg-soft-danger text-danger":"1"==s.status,"bg-soft-info text-info":"0"==s.status}),children:["2"==s.status&&(0,y.jsx)("i",{className:"mdi mdi-bitcoin me-1"}),"1"==s.status&&(0,y.jsx)("i",{className:"mdi mdi-cancel me-1"}),"0"==s.status&&(0,y.jsx)("i",{className:"mdi mdi-cash me-1"}),j.n[s.status]]})})})},I=e=>{let{row:s}=e;return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)("h5",{children:(0,y.jsx)("span",{className:m()("badge",{"bg-success":null!==s.quickbook_id,"bg-warning":null===s.quickbook_id}),children:s.quickbook_id?"Syced":"Not Synced"})})})},D=e=>{let{row:s,deleteInvoice:a}=e;const t=(0,u.wA)();let{user:n,customerUser:r}=(0,u.d4)((e=>({user:e.Auth.user,customerUser:e.CustomerAuth.user})));n||(n=r);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(l.N_,{to:"/invoice/".concat(s.id),className:"action-icon",children:[" ",(0,y.jsx)("i",{className:"mdi mdi-eye"})]}),(0,y.jsx)(y.Fragment,{children:n.user_role.includes("admin")||n.user_role.includes("staff")?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(l.N_,{to:"/invoice-edit/".concat(s.id),className:"action-icon",children:[" ",(0,y.jsx)("i",{className:"mdi mdi-square-edit-outline"})]}),(0,y.jsxs)(l.N_,{to:"#",className:"action-icon",onClick:()=>a(s.id),children:[" ",(0,y.jsx)("i",{className:"mdi mdi-delete"})]}),(0,y.jsxs)(l.N_,{to:"#",onClick:()=>{return e=s.id,void t((0,x.Rs)(e));var e},"aria-disabled":!0,className:"action-icon",title:"Sync with Quickbook",children:[" ",(0,y.jsx)("i",{className:"mdi mdi-sync"})]})]}):(0,y.jsx)(y.Fragment,{})})]})},T=()=>{const[e,s]=(0,t.useState)(""),[a,d]=(0,t.useState)(""),[m,g]=(0,t.useState)(0),[b,N]=(0,t.useState)(!1),[v,f]=(0,t.useState)(""),w=(0,u.wA)(),[C,A]=(0,t.useState)(1),{invoice:T,users:P,refresh:H,message:L,status:E}=(0,u.d4)((e=>({invoice:e.Invoice.invoice,users:e.User.occupants,refresh:e.Invoice.refresh,message:e.Invoice.message,status:e.Invoice.status}))),[O,B]=(0,t.useState)(!1);let{user:U,customerUser:z}=(0,u.d4)((e=>({user:e.Auth.user,customerUser:e.CustomerAuth.user})));U||(U=z),(0,t.useEffect)((()=>{(U.user_role.includes("admin")||U.user_role.includes("staff"))&&w((0,S.hW)())}),[]),(0,t.useEffect)((()=>{w((0,x.gP)({page:C,filter:v}))}),[C,v,H,O,b]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(h.A,{breadCrumbItems:[{label:"Rent history",path:"/invoice",active:!0}],title:"Rent History"}),(0,y.jsx)(n.A,{children:(0,y.jsx)(r.A,{children:(0,y.jsx)(i.A,{children:(0,y.jsxs)(i.A.Body,{children:[E&&(0,y.jsx)("div",{className:"alert alert-success",children:L}),!E&&L&&(0,y.jsx)("div",{className:"alert alert-danger mt-3",role:"alert",dangerouslySetInnerHTML:{__html:L}}),(0,y.jsxs)(n.A,{className:"align-items-center",children:[(0,y.jsx)(r.A,{lg:8,children:(0,y.jsx)("form",{className:"row gy-2 gx-2 align-items-center justify-content-lg-start justify-content-between",children:(0,y.jsx)("div",{className:"col-auto",children:(0,y.jsxs)("div",{className:"d-flex align-items-center w-auto",children:[(0,y.jsx)("label",{htmlFor:"status-select",className:"me-2",children:"Status"}),(0,y.jsxs)("select",{className:"form-select",id:"status-select",onChange:e=>{return s=e.target.value,void f(s);var s},children:[(0,y.jsx)("option",{value:"",children:"All"}),Object.keys(j.n).map((e=>(0,y.jsx)("option",{value:e,children:j.n[e]},"status".concat(e))))]})]})})})}),(0,y.jsx)(r.A,{lg:4,children:(0,y.jsx)("div",{className:"text-lg-end mt-xl-0 mt-2",children:U.user_role.includes("admin")||U.user_role.includes("staff")?(0,y.jsxs)(c.A,{className:"btn  mb-2 me-2",onClick:()=>B(!0),children:[(0,y.jsx)("i",{className:"mdi mdi-basket me-1"})," Create a Invoice"]}):(0,y.jsx)(y.Fragment,{})})})]}),(0,y.jsx)(i.A,{children:(0,y.jsxs)(i.A.Body,{children:[e&&(0,y.jsx)("div",{className:"alert alert-success",children:e}),a&&(0,y.jsx)("div",{className:"alert alert-danger mt-3",role:"alert",children:a}),(0,y.jsx)("div",{className:"table-responsive",children:(0,y.jsxs)(o.A,{className:"table table-centered react-table dt-responsive nowrap w-100",children:[(0,y.jsx)("thead",{className:"table-light",children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{children:"ID"}),(0,y.jsx)("th",{children:"Suite"}),(0,y.jsx)("th",{children:"Status"}),(0,y.jsx)("th",{children:"Due Date"}),(0,y.jsx)("th",{children:"Created At"}),(0,y.jsx)("th",{children:"QuickBook Status"}),(0,y.jsx)("th",{children:"Actions"})]})}),(0,y.jsx)("tbody",{children:T&&T.data.length>0?T.data.map(((e,s)=>{var a,t,n;return(0,y.jsxs)("tr",{role:"row",children:[(0,y.jsx)("td",{role:"cell",children:(0,y.jsxs)(l.N_,{to:"/invoice/".concat(e.id),className:"text-body fw-bold",children:["#",e.id]})}),(0,y.jsxs)("td",{role:"cell",children:[null===(a=e.flat)||void 0===a?void 0:a.name," - ",null===(t=e.flat)||void 0===t||null===(n=t.apartment)||void 0===n?void 0:n.name]}),(0,y.jsx)("td",{role:"cell",children:(0,y.jsx)(F,{row:e})}),(0,y.jsx)("td",{role:"cell",children:e.due_date}),(0,y.jsx)("td",{role:"cell",children:e.created_at}),(0,y.jsx)("td",{role:"cell",children:(0,y.jsx)(I,{row:e})}),(0,y.jsx)("td",{role:"cell",children:(0,y.jsx)(D,{row:e,deleteInvoice:e=>{N(!0),g(e)}})})]},s)})):(0,y.jsx)("p",{children:"No Data Found"})})]})}),T&&(0,y.jsx)(p.A,{tableProps:{pageCount:T.last_page,state:{pageIndex:T.current_page},pageOptions:{length:T.total},gotoPage:e=>{A(e)}},sizePerPageList:[{text:"10",value:10}]})]})}),P&&(0,y.jsx)(_.m,{title:"Are you sure you want to delete invoice?",show:b,targetId:m,submitForm:e=>{s(""),d(""),w((0,x.bb)(e)).unwrap().then((e=>{e&&!0===e.status&&(s(e.message),N(!1))})).catch((e=>{d(e.message),N(!1)}))},handleClose:()=>N(!1)}),P&&(0,y.jsx)(k,{users:P,show:O,onHide:()=>{B(!1)},onSubmit:()=>{}})]})})})})]})}},94166:(e,s,a)=>{a.d(s,{n:()=>t});const t={0:"Unpaid",1:"Payment Failed",2:"Paid"}}}]);