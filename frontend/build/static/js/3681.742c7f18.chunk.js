"use strict";(self.webpackChunkujatcare=self.webpackChunkujatcare||[]).push([[3681],{33681:(e,a,r)=>{r.r(a),r.d(a,{default:()=>S});var s=r(47313),n=r(75627),t=r(65832),l=r(63849),i=r(31616),o=r(88178),d=r(87021),c=r(41709),m=r(93298),u=r(51450),h=r(93633),x=r(1084),g=r(58467),j=r(2135),p=r(33689),v=r(52487),b=r(14056),_=r.n(b),y=r(62563),Z=r(3463),k=r(5191),N=r(46417);const f=()=>{var e;const a=(0,y.X)(Z.Ry().shape({work_requested:Z.Z_().required("Please select Work Requested"),tanent_name:Z.Z_().required("Please enter tanent name")})),[r,u]=(0,s.useState)(""),[b,f]=(0,s.useState)(""),[S,w]=(0,s.useState)();let{user:C,customerUser:D}=(0,x.v9)((e=>({user:e.Auth.user,customerUser:e.CustomerAuth.user})));C||(C=D);const L=(0,n.cI)({defaultValues:{},resolver:a}),{handleSubmit:T,register:F,setError:R,control:q,watch:O,setValue:P,reset:I,formState:{errors:U}}=L,E=(0,x.I0)();let M=(0,s.useRef)(null),G=(0,s.useRef)(null);const[W,A]=(0,s.useState)(new Date),[Y,B]=(0,s.useState)(new Date),[V,z]=(0,s.useState)(new Date);(0,s.useEffect)((()=>{E((0,h.JV)(H.id)).unwrap().then((e=>{var a,r,s;null!==e&&(P("id",e.id),P("tanent_name",null===e||void 0===e?void 0:e.tanent_name),P("work_requested",null===e||void 0===e?void 0:e.work_requested),P("tanent_signature",null===e||void 0===e?void 0:e.tanent_signature),null===(a=M.current)||void 0===a||a.fromDataURL(null===e||void 0===e?void 0:e.tanent_signature),G.current&&G.current.fromDataURL(null===e||void 0===e?void 0:e.service_signature),P("service_signature",null===e||void 0===e?void 0:e.service_signature),P("phone",null===e||void 0===e?void 0:e.phone),P("ok_to_enter",null===e||void 0===e?void 0:e.ok_to_enter.toString()),P("action_taken",null!==(r=null===e||void 0===e?void 0:e.action_taken)&&void 0!==r?r:""),P("action_date",null===e||void 0===e?void 0:e.action_date),P("work_done",null===e||void 0===e?void 0:e.work_done),P("status",null===e||void 0===e?void 0:e.status.toString()),null!==e&&void 0!==e&&e.chargable&&P("chargable",null===e||void 0===e?void 0:e.chargable.toString()),null!==e&&void 0!==e&&e.action_date&&A(new Date(null===e||void 0===e?void 0:e.action_date)),null!==e&&void 0!==e&&e.time_in&&B(new Date("2024-12-12 "+(null===e||void 0===e?void 0:e.time_in))),null!==e&&void 0!==e&&e.time_out&&z(new Date("2024-12-12 "+(null===e||void 0===e?void 0:e.time_out))),E((0,p.fB)(e.user_id)).unwrap().then((e=>{w(e)})),M.current&&(null===(s=M.current)||void 0===s||s.off()))})).catch((e=>f(e)))}),[]);const Q=T((async e=>{E((0,h.rF)(e)).unwrap().then((e=>{e&&!0===e.status&&(u(e.message),f(""),window.scrollTo({top:0,behavior:"smooth"}))})).catch((e=>{for(var a in e.errors)try{R(a,{message:e.errors[a].toString()})}catch(r){}}))})),H=(0,g.UO)();return(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(t.Z,{children:(0,N.jsxs)(t.Z.Body,{children:[r&&(0,N.jsxs)("div",{className:"alert alert-success",children:[r,(0,N.jsx)(j.rU,{to:"/maintanance-admin",children:" Back to Maintanance."})]}),b&&(0,N.jsx)("div",{className:"alert alert-danger mt-3",role:"alert",children:b}),(0,N.jsxs)("form",{onSubmit:Q,children:[(0,N.jsxs)(l.Z,{children:[(0,N.jsx)(i.Z,{lg:4,children:(0,N.jsxs)(o.Z.Group,{className:"mb-3",children:[(0,N.jsx)(o.Z.Label,{className:"me-2",children:"Building"}),(0,N.jsx)(o.Z.Label,{children:S&&S.user.apartment_name}),(0,N.jsx)(v.y,{type:"hidden",name:"user_id",value:C.user_id,disabled:!0,register:F}),(0,N.jsx)(v.y,{type:"hidden",name:"id",register:F,disabled:!0})]})}),(0,N.jsx)(i.Z,{lg:3,children:(0,N.jsxs)(o.Z.Group,{className:"mb-3 input-group",children:[(0,N.jsx)(o.Z.Label,{htmlFor:"small",className:"me-2",children:"Apt"}),(0,N.jsx)(o.Z.Label,{children:S&&S.user.flat_name}),(0,N.jsx)(v.y,{type:"hidden",disabled:!0,name:"flat_id",value:S&&(null===(e=S.user.flat)||void 0===e?void 0:e.flat_id),register:F})]})})]}),(0,N.jsxs)(l.Z,{children:[(0,N.jsx)(i.Z,{lg:4,children:(0,N.jsx)(v.y,{label:"Tanent Name",type:"text",disabled:!0,register:F,name:"tanent_name",errors:U,className:"form-control-sm ",containerClass:"mb-3 input-group",labelClassName:"me-2",size:2},"tanent_name")}),(0,N.jsx)(i.Z,{lg:3,children:(0,N.jsx)(v.y,{label:"Phone",type:"text",disabled:!0,register:F,name:"phone",errors:U,className:"form-control-sm",containerClass:"mb-3 input-group",labelClassName:"me-2",size:2},"phone")}),(0,N.jsx)(i.Z,{lg:5,children:(0,N.jsxs)(o.Z.Group,{className:"mb-3 input-group",children:[(0,N.jsx)(o.Z.Label,{htmlFor:"small",className:"me-2",children:"Ok to Enter"}),(0,N.jsx)(v.y,{type:"radio",disabled:!0,className:"form-check-inline",name:"ok_to_enter",label:"Yes",value:"1",register:F}),(0,N.jsx)(v.y,{type:"radio",disabled:!0,className:"form-check-inline",name:"ok_to_enter",label:"No",value:"2",register:F})]})})]}),(0,N.jsx)(l.Z,{children:(0,N.jsx)(i.Z,{lg:12,children:(0,N.jsx)(v.y,{type:"textarea",title:"Work Requested",name:"work_requested",disabled:!0,placeholder:"Work Requested",className:"mb-3",register:F,errors:U,style:{height:"100px"}})})}),(0,N.jsx)(l.Z,{children:(0,N.jsx)(i.Z,{lg:12,children:(0,N.jsxs)(d.Z,{className:"mb-3",children:[(0,N.jsx)(c.Z,{className:"me-1 ",children:"Signature"}),(0,N.jsx)(n.Qr,{control:q,name:"tanent_signature",render:e=>{let{field:a}=e;return(0,N.jsx)(_(),{ref:M,onEnd:()=>a.onChange((()=>{if(M.current)return M.current.toDataURL()})()),penColor:"green",canvasProps:{width:500,height:50,style:{border:"1px solid green"}}})}}),(0,N.jsx)(v.y,{name:"tanent_signature",register:F,errors:U,disabled:!0,className:"is-invalid",type:"hidden"}),U&&U.tanent_signature?(0,N.jsx)(o.Z.Control.Feedback,{type:"invalid",children:U.tanent_signature.message}):null]})})}),(0,N.jsx)(l.Z,{children:(0,N.jsx)(i.Z,{lg:12,children:(0,N.jsxs)(o.Z.Group,{className:"mb-3 input-group",children:[(0,N.jsx)(o.Z.Label,{htmlFor:"small",className:"me-2",children:"Action Taken"}),(0,N.jsx)(v.y,{type:"radio",className:"form-check-inline",name:"action_taken",register:F,value:1,label:"Work Completed"}),(0,N.jsx)(v.y,{type:"radio",className:"form-check-inline",name:"action_taken",value:2,register:F,label:"Repaired Temporarily"}),(0,N.jsx)(v.y,{type:"radio",className:"form-check-inline",name:"action_taken",register:F,value:3,label:"Parts on Order"}),(0,N.jsx)(v.y,{type:"radio",className:"form-check-inline",name:"action_taken",register:F,value:4,label:"Outside Contractor Called"})]})})}),(0,N.jsxs)(l.Z,{children:[(0,N.jsx)(i.Z,{lg:4,children:(0,N.jsxs)(d.Z,{className:"input-group mb-3 ",children:[(0,N.jsx)(o.Z.Label,{htmlFor:"small",className:"me-2",children:"Date"}),(0,N.jsx)(v.y,{type:"hidden",register:F,name:"action_date",value:W.toISOString().split("T")[0]},"action_date"),(0,N.jsx)(k.Z,{hideAddon:!0,value:W,showTimeSelect:!1,inputClass:"form-control-sm ",dateFormat:"MM-DD-YYYY",onChange:e=>{A(e),P("action_date",e.toLocaleString("sv-SE"))}}),U&&U.action_date?(0,N.jsx)(o.Z.Control.Feedback,{type:"invalid",children:U.action_date.message}):null]})}),(0,N.jsx)(i.Z,{lg:4,children:(0,N.jsxs)(d.Z,{className:"input-group mb-3 ",children:[(0,N.jsx)(o.Z.Label,{htmlFor:"small",className:"me-2",children:"Time In"}),(0,N.jsx)(v.y,{type:"hidden",register:F,name:"time_in",errors:U},"time_in"),(0,N.jsx)(k.Z,{value:Y,showTimeSelect:!0,showTimeSelectOnly:!0,inputClass:"form-control-sm",onChange:e=>{B(e),P("time_in",Y.toLocaleTimeString("it-IT"))}}),U&&U.time_in?(0,N.jsx)(o.Z.Control.Feedback,{type:"invalid",children:U.time_in.message}):null]})}),(0,N.jsx)(i.Z,{lg:4,children:(0,N.jsxs)(d.Z,{className:"input-group mb-3 ",children:[(0,N.jsx)(o.Z.Label,{htmlFor:"small",className:"me-2",children:"Time Out"}),(0,N.jsx)(v.y,{type:"hidden",register:F,name:"time_out",errors:U},"time_out"),(0,N.jsx)(k.Z,{value:V,showTimeSelect:!0,showTimeSelectOnly:!0,inputClass:"form-control-sm",onChange:e=>{z(e),P("time_out",V.toLocaleTimeString("it-IT"))}}),U&&U.time_out?(0,N.jsx)(o.Z.Control.Feedback,{type:"invalid",children:U.time_out.message}):null]})})]}),(0,N.jsx)(l.Z,{children:(0,N.jsx)(i.Z,{lg:12,children:(0,N.jsx)(v.y,{type:"textarea",title:"Work Done",name:"work_done",placeholder:"Work Done",className:"mb-3",register:F,errors:U,style:{height:"125px"}})})}),(0,N.jsx)(l.Z,{children:(0,N.jsx)(i.Z,{lg:12,children:(0,N.jsxs)(d.Z,{className:"mb-3",children:[(0,N.jsx)(c.Z,{className:"me-1 ",children:"Service Person Signature"}),(0,N.jsx)(n.Qr,{control:q,name:"service_signature",render:e=>{let{field:a}=e;return(0,N.jsx)(_(),{ref:G,onEnd:()=>a.onChange((()=>{if(G.current)return G.current.toDataURL()})()),penColor:"green",canvasProps:{width:500,height:50,style:{border:"1px solid green"}}})}}),(0,N.jsx)(v.y,{name:"service_signature",register:F,errors:U,className:"is-invalid",type:"hidden"})]})})}),(0,N.jsx)(l.Z,{children:(0,N.jsx)(i.Z,{lg:12,children:(0,N.jsxs)(o.Z.Group,{className:"mb-3 input-group",children:[(0,N.jsx)(v.y,{type:"radio",name:"chargable",value:1,register:F,label:"Chargable to Occupant",className:"form-check-inline"}),(0,N.jsx)(v.y,{type:"radio",name:"chargable",value:2,register:F,label:"Management",className:"form-check-inline"}),(0,N.jsx)(v.y,{type:"hidden",name:"repaired_by",register:F,value:C.user_id})]})})}),(0,N.jsx)(l.Z,{children:(0,N.jsx)(i.Z,{lg:12,children:(0,N.jsxs)(o.Z.Group,{className:"mb-3 input-group",children:[(0,N.jsx)(o.Z.Label,{children:"Status:"}),(0,N.jsx)(v.y,{type:"radio",id:"repair_status",name:"status",value:1,register:F,label:"Pending",className:"form-check-inline"}),(0,N.jsx)(v.y,{type:"radio",name:"status",id:"repair_status",value:2,register:F,label:"In Progress",className:"form-check-inline"}),(0,N.jsx)(v.y,{type:"radio",name:"status",id:"repair_status",value:3,register:F,label:"On Hold",className:"form-check-inline"}),(0,N.jsx)(v.y,{type:"radio",name:"status",id:"repair_status",value:4,register:F,label:"Done",className:"form-check-inline"})]})})}),(0,N.jsx)(l.Z,{children:(0,N.jsx)(i.Z,{lg:3,children:(0,N.jsx)(m.Z,{variant:"primary",type:"submit",children:"Submit"})})})]})]})})})},S=()=>(0,N.jsxs)(s.Fragment,{children:[(0,N.jsx)(u.Z,{breadCrumbItems:[{label:"Dashboard",path:"/dashboard-1"},{label:"Maintanance",path:"/maintanance"},{label:"Maintanance Edit",path:"/maintanance",active:!0}],title:"Maintanance Request"}),(0,N.jsx)(l.Z,{children:(0,N.jsx)(i.Z,{children:(0,N.jsx)(f,{})})})]})}}]);